# TIL: JDBC
**학습날짜: 2025년 02월 10일**

**어떤 문제가 있었는지?**  
JAVA를 이용하여 Database를 사용하는 JDBC를 배웠음.  
우선 Database 개념도 필요하기 때문에 DB에 대한 기본 개념도 배웠음.  
배웠던 내용이지만 한 번 더 복습하는 개념으로 정리함.  

```
Database

- Transaction
    - 작업의 최소단위!
    - ACID 보장을 위해 설정함
        - Atomicity(원자성) ⇒ All or Nothing
        - Consistency(일치성)
        - Isolation(독립성)
        - Durability(영구성)
    - ex) SQL 구문 5개를 Transaction으로 설정(이체)
        - select 잔액
        - select 계좌 존재?, select 잔액
        - update 잔액 -1000
        - update 잔액 +1000
- JDBC + Transaction
    - Connection에 설정
```

이외에도 JDBC를 실제로 코드를 쳐서 Database와 연결하여 데이터를 읽고 쓰고 하는 실습 진행.  


**그 문제를 해결하기 위해 시도해본 것들**  
강사님이 써주시는 코드를 따라 작성하며 주석들을 작성.  
어떤 코드가 어떤 역할을 하는지 이해하면서 작성하니 이해가 빨랐음.  

아래에 작성코드를 첨부함.  
```
package first;

//import com.sun.jdi.connect.spi.Connection;

import java.sql.*;

// JDBC는 크게 6개의 단계로 사용해요!
// 1. (JDBC)Driver Loading
// 프로그램에서 딱 1번만 수행하면 됩니다!
// 2. 데이터베이스 연결
// 만약 연결이 성공하면 연결성공의 증표로 객체가 생성!
// 객체의 Class는 java.sql.Connection class
// 연결을 하려면 3가지 정보가 필요해요!
// - 어떤 데이터베이스에 접속하는지에 대한 정보(문자열) => JDBC URL
// - ID / PW가 필요.
// 3. SQL을 작성해요 => PreparedStatement를 생성
// 4. Query 실행
//    - executeUpdate() : SQL구문이 insert, update, delete 계열일 때 사용
//                        리턴값은 SQL에 의해서 영향을 받은 행의 수
//    - executeQuery() : SQL구문이 select일 때 사용
// 5. 결과처리
//    - executeUpdate()인 경우 리턴값은 SQL에 의해서 영향을 받은 행의 수(int)
//    - executeQuery()인 경우 ResultSet이 결과로 나와요.
// 6. 리소스 해제
//    - 지금 사용된 자원은
//    - Connection, PreparedStatement, ResultSet

public class FirstConnect {
    public static void main(String[] args) {

        try {
            Class.forName("oracle.jdbc.driver.OracleDriver");
            System.out.println("드라이버 로딩 성송");
            Connection con = null;
            String JDBC_URL = "jdbc:oracle:thin:@localhost:1521:xe";
            String ID = "C##DEV";
            String PW = "1234";
            con = DriverManager.getConnection(JDBC_URL, ID, PW);
            System.out.println("데이터베이스 연결 성공!");

            String sql = "select btitle from book where bisbn='89-7914-063-0'";

            // SQL 문장을 얹어서 보낼 Statement 객체를 생성해요!
            // Statement는 크게 3개가 있어요!
            // 1. 일반 Statement => 단순, 기능상으로는 약간 부족. 잘 안써요!
            // 2. PreparedStatement => 이걸 많이 써요. 편리성,
            //                         - 코드작성하기 편해요!
            //                         - 효율이 좋아요!
            //                         - SQL Injection을 방지
            // 3. CallableStatement => Stored Procedure를 호출하기 위해서 사용.
            PreparedStatement pstmt = con.prepareStatement(sql);

            // Query 실행!!
            ResultSet rs = pstmt.executeQuery();

            // 결과 처리
            if(rs.next()) {
                // 결과가 존재하면
                System.out.println(rs.getString("btitle"));
            } else {
                System.out.println("검색 결과가 없습니다.");
            }
            rs.close();
            pstmt.close();
            con.close();

        }  catch (ClassNotFoundException e) {
            System.out.println("Driver를 찾을 수 없어요!");
        }  catch(SQLException e1) {
            System.out.println("연결에 문제가 있어요!");
        }

    }
}

```



**어떻게 그 문제를 해결했는지**  
그리고 추가로 transaction까지 어떻게 코드를 작성하는지 배웠음.  
JDBC rollback, commit을 이용하여 데이터의 완결을 하는 부분까지도 적용함.  


**오늘 내가 새롭게 배운 것들**  
JDBC의 경우 들어는 봤지만 실제로 코드를 작성하여서 DB와 연결해 본 적은 없음.  
직접 코드를 작성하면서 익숙해지는 시간을 가졌음.  
